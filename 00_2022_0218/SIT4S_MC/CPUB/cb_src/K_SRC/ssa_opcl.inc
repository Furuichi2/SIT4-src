
	.GLOBAL		_PAR_COP_CNTROT_ZDG1	;+10.0ìx
	.GLOBAL		_CB_SYS_PARAM081	;âÒì] æﬁ€í≤èIóπ    =â◊èdë™íËäJénäpìx
	.GLOBAL		_PAR_COP_CNTROT_ZDG2	;+20.0ìx
	.GLOBAL		_CB_SYS_PARAM082	;âÒì] â◊èdë™íËäJénäpìx
	.GLOBAL		_PAR_COP_CNTROT_SDG1	;+20.0ìx
	.GLOBAL		_CB_SYS_PARAM083	;âÒì] â◊èdë™íËäJénèIóπ
	.GLOBAL		_PAR_COP_CNTROT_SDG2	;230.0ìx
	.GLOBAL		_CB_SYS_PARAM084	;îΩì] æﬁ€í≤äJénäpìx   +N
	.GLOBAL		_PAR_COP_REVRSE_ZDG1	;5.0ìx
	.GLOBAL		_CB_SYS_PARAM085	;îΩì] æﬁ€í≤äJénèIóπ   +M
	.GLOBAL		_PAR_COP_REVRSE_ZDG2	;15.0ìx
	.GLOBAL		_CB_SYS_PARAM086	;îΩì] â◊èdë™íËäJénäpìx+N 
	.GLOBAL		_PAR_COP_REVRSE_SDG1	;ë“ã@ì_+5.0ìxÇâ°êÿÇ¡ÇΩäpìx
	.GLOBAL		_CB_SYS_PARAM087	;îΩì] â◊èdë™íËäJénèIóπ+M
	.GLOBAL		_PAR_COP_REVRSE_SDG2	;ë“ã@ì_+5.0ìxÇâ°êÿÇ¡ÇΩäpìx:ç≈èIçHíˆà»ç~
	


	.EXPORT	_COP1_ROT_DT_INI
	
	.IMPORT	_ATOB_KJYUALL_SMPCLR		
	.IMPORT	_ATOB_KJYUALL_SMPSTART		;
	.IMPORT	_ATOB_KJYUTRD_SMPCLR		;CPUA=>CPUB 1: CPUB=0CLR CPUBÇÕ0∏ÿ±Ç∑ÇÈ
	.IMPORT	_ATOB_KJYUTRD_SMPSTART		;CPUA= 0->1 1->0         CPUBÇÕéQè∆ÇÃÇ›

;	*******************************************
;	***					***
;	***	√ﬁ∞¿ì]ëó ïÑçÜägí£		***
;	***	2Bor4B-->2B/4B			***
;	*******************************************
;;	.MACRO	DATA_STD_SHN_MOV	SRC,L1,DST,L2
;;	MOV.L	#\SRC,R5		;
;;	MOV.\L1	@R5,R2			;
;;
;;	MOV.L	#\DST,R6		;
;;	MOV.\L2	R2,@R6			;
;;	.ENDM
;;
;;	.MACRO	DATA_STD_CHG_MOV	SRC,L1,DST,L2,CALLSB
;;	MOV.L	#\SRC,R8						;
;;	MOV.\L1	@R8,R2							;
;;
;;	FAR_JSR	#\CALLSB,R0		;
;;
;;	MOV.L	#\DST,R9		;
;;	MOV.\L2	R2,@R9			;
;;	.ENDM


_COP1_ROT_DT_INI:
	SUB_START
	FAR_JSR	#_CB_COP_DT_MAK1,R0
	FAR_JSR	#_CB_COP_DT_MAK2,R0

	MOV.L	#_INC_ENC360,R1		;//360.0ìx(¥›∫∞¿ﬁÇÕï\é¶Ç∆ìØÇ∂)
	MOV.W	@R1,R2			;
;;;ñ¢égóp	MOV.L	#_COP_ENC3600,R1	;
;;;ñ¢égóp	MOV.W	R2,@R1			;
	MOV.L	#_COP_OLD_ENC3600,R1	;
	MOV.W	R2,@R1			;
	MEM1_BIT0_TO_BIT7_ORSET MEM=_COP_CB_LD_MONI_SIG,LG=W,BIT=(BIT0),WKREG=R1

;	SH4-->SH2Ç÷ìnÇ∑Å@2010-12-08
	MEM_MOV_TO_MEM	SRC_ADR=_COP_CB_LD_MONI_SIG,L1=W,DST_ADR=_DP_COP_CB_LD_MONI_SIG,L2=W,WKREG1=R1,WKREG2=R2,WKREG3=R3


	SUB_END
	M_RTS

;	***********************************
;	***				***
;	***	 ﬂ◊“∞¿			***
;	***	∏◊›∏ê›íËÇ∆Ç∑ÇÈ		***
;	***	ëSÇƒë“ã@ì_Å{Ç≈àµÇ§	***
;	***				***
;	***********************************


_CB_COP_DT_MAK1:
	SUB_START
	DATA_STD_SHN_MOV	SRC=_PAR_COP_CNTROT_ZDG1,L1=W,DST=_WPAR_COP_CNTROT_ZDG1,L2=W
	DATA_STD_SHN_MOV	SRC=_PAR_COP_CNTROT_ZDG2,L1=W,DST=_WPAR_COP_CNTROT_ZDG2,L2=W
	DATA_STD_SHN_MOV	SRC=_PAR_COP_CNTROT_SDG1,L1=W,DST=_WPAR_COP_CNTROT_SDG1,L2=W
	DATA_STD_SHN_MOV	SRC=_PAR_COP_CNTROT_SDG2,L1=W,DST=_WPAR_COP_CNTROT_SDG2,L2=W

	DATA_STD_SHN_MOV	SRC=_PAR_COP_REVRSE_ZDG1,L1=W,DST=_WPAR_COP_REVRSE_ZDG1,L2=W
	DATA_STD_SHN_MOV	SRC=_PAR_COP_REVRSE_ZDG2,L1=W,DST=_WPAR_COP_REVRSE_ZDG2,L2=W
	DATA_STD_SHN_MOV	SRC=_PAR_COP_REVRSE_SDG1,L1=W,DST=_WPAR_COP_REVRSE_SDG1,L2=W
	DATA_STD_SHN_MOV	SRC=_PAR_COP_REVRSE_SDG2,L1=W,DST=_WPAR_COP_REVRSE_SDG2,L2=W


	SUB_END
	M_RTS

;	===================================
;	===				===
;	===	ìÆçÏéûÇÃì¸ÇÍë÷Ç¶	===
;	===				===
;	===================================
;	ë“ã@ì_Å{ê›íËÇ…ïœä∑Ç∑ÇÈ
_CB_COP_DT_MAK2:
	SUB_START

;	=========[2009-10-07â∫êUéq]
	MOV.L	#_SET1_MRTION_SEL1,R1						;
	MOV.W	@R1,R0								;
	TST	#(_DMATH_DNDRIV),R0						;2007-09-06
	TST_BIT_ON CB_COP_DT_MK2_010						;
	M_BRA	CB_COP_DT_MK2_050						;

CB_COP_DT_MK2_010						;

;	-------âùòH-------
;	îΩì]ÇÃ√ﬁ∞¿ÇégópÇ∑ÇÈ
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_REVRSE_ZDG1,L1=W,DST=_WPARX_COP_DNDRV1_ZDG1,L2=W,CALLSB=_TAIKI_ADD;
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_REVRSE_ZDG2,L1=W,DST=_WPARX_COP_DNDRV1_ZDG2,L2=W,CALLSB=_TAIKI_ADD;
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_REVRSE_SDG1,L1=W,DST=_WPARX_COP_DNDRV1_SDG1,L2=W,CALLSB=_TAIKI_ADD;
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_REVRSE_SDG2,L1=W,DST=_WPARX_COP_DNDRV1_SDG2,L2=W,CALLSB=_NEG_TAIKI_SUB;

;	-------ïúòH-------
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_REVRSE_ZDG2,L1=W,DST=_WPARX_COP_DNDRV2_ZDG1,L2=W,CALLSB=_NEG_TAIKI_SUB;
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_REVRSE_ZDG1,L1=W,DST=_WPARX_COP_DNDRV2_ZDG2,L2=W,CALLSB=_NEG_TAIKI_SUB;
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_REVRSE_SDG2,L1=W,DST=_WPARX_COP_DNDRV2_SDG1,L2=W,CALLSB=_TAIKI_ADD;
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_REVRSE_SDG1,L1=W,DST=_WPARX_COP_DNDRV2_SDG2,L2=W,CALLSB=_NEG_TAIKI_SUB;


;	-- 2007-09-06 [â◊èdï‚ê≥][Ç”ÇËÇ±âùòH]
	DATA_STD_SHN_MOV	SRC=_SET1_KJSTR_DIG1,L1=W,DST=_SETX_KJSTR_DIG1,L2=W;
	DATA_STD_SHN_MOV	SRC=_SET1_KJEND_DIG1,L1=W,DST=_SETX_KJEND_DIG1,L2=W;

;	-----------------------[Ç”ÇËÇ±ïúòH]
	DATA_STD_CHG_MOV	SRC=_SET1_KJEND_DIG1,L1=W,DST=_SETY_KJSTR_DIG1,L2=W,CALLSB=_NEG_TAIKI;
	DATA_STD_CHG_MOV	SRC=_SET1_KJSTR_DIG1,L1=W,DST=_SETY_KJEND_DIG1,L2=W,CALLSB=_NEG_TAIKI;



;	-- 2014-05-30 --[ƒ⁄›ƒﬁ][Ç”ÇËÇ±âùòH]
;;;;;2014-10-10ïsãÔçá	DATA_STD_SHN_MOV	SRC=_SET1_KJSTR_DIG2,L1=W,DST=_SETC_KJSTR_DIG2,L2=W;
;;;;;2014-10-10ïsãÔçá	DATA_STD_SHN_MOV	SRC=_SET1_KJEND_DIG2,L1=W,DST=_SETC_KJEND_DIG2,L2=W;
	DATA_STD_SHN_MOV	SRC=_SET1_KJSTR_DIG2,L1=W,DST=_SETX_KJSTR_DIG2,L2=W;
	DATA_STD_SHN_MOV	SRC=_SET1_KJEND_DIG2,L1=W,DST=_SETX_KJEND_DIG2,L2=W;

;	-----------------------[Ç”ÇËÇ±ïúòH]
	DATA_STD_CHG_MOV	SRC=_SET1_KJEND_DIG2,L1=W,DST=_SETY_KJSTR_DIG2,L2=W,CALLSB=_NEG_TAIKI;
	DATA_STD_CHG_MOV	SRC=_SET1_KJSTR_DIG2,L1=W,DST=_SETY_KJEND_DIG2,L2=W,CALLSB=_NEG_TAIKI;
	M_BRA	CB_COP_DT_MK2_200



CB_COP_DT_MK2_050:
;;[2009-10-07â∫êUéq]	MOV.L	#_SET1_MRTION_SEL1,R1	;
;;[2009-10-07â∫êUéq]	MOV.W	@R1,R0			;
	CMP/EQ	#_DMATH_CNTROT,R0	;DRIVE MATH òAë±âÒì]
	BF	CB_COP_DT_MK2_100	;NO:îΩì]

;	------- âÒì](ë“ã@ì_0ÇæÇ©ÇÁÇ¢Ç¢ÇØÇ«)-------
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_CNTROT_ZDG1,L1=W,DST=_WPAR_COP_ZDG1,L2=W,CALLSB=_TAIKI_ADD;
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_CNTROT_ZDG2,L1=W,DST=_WPAR_COP_ZDG2,L2=W,CALLSB=_TAIKI_ADD;
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_CNTROT_SDG1,L1=W,DST=_WPAR_COP_SDG1,L2=W,CALLSB=_TAIKI_ADD;
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_CNTROT_SDG2,L1=W,DST=_WPAR_COP_SDG2,L2=W,CALLSB=_TAIKI_ADD;

;	-- 2009-10-07 --[â◊èdï‚ê≥][âÒì]]
	DATA_STD_SHN_MOV	SRC=_SET1_KJSTR_DIG1,L1=W,DST=_SETC_KJSTR_DIG1,L2=W;
	DATA_STD_SHN_MOV	SRC=_SET1_KJEND_DIG1,L1=W,DST=_SETC_KJEND_DIG1,L2=W;

;	-- 2014-05-30 --[ƒ⁄›ƒﬁ][âÒì]]
	DATA_STD_SHN_MOV	SRC=_SET1_KJSTR_DIG2,L1=W,DST=_SETC_KJSTR_DIG2,L2=W;
	DATA_STD_SHN_MOV	SRC=_SET1_KJEND_DIG2,L1=W,DST=_SETC_KJEND_DIG2,L2=W;

	M_BRA	CB_COP_DT_MK2_200	

CB_COP_DT_MK2_100:
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_REVRSE_ZDG1,L1=W,DST=_WPAR_COP_ZDG1,L2=W,CALLSB=_TAIKI_ADD;
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_REVRSE_ZDG2,L1=W,DST=_WPAR_COP_ZDG2,L2=W,CALLSB=_TAIKI_ADD;
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_REVRSE_SDG1,L1=W,DST=_WPAR_COP_SDG1,L2=W,CALLSB=_TAIKI_ADD;
	DATA_STD_CHG_MOV	SRC=_WPAR_COP_REVRSE_SDG2,L1=W,DST=_WPAR_COP_SDG2,L2=W,CALLSB=_TAIKI_ADD;

;	-- 2009-10-07 --[â◊èdï‚ê≥][îΩì]]
	DATA_STD_SHN_MOV	SRC=_SET1_KJSTR_DIG1,L1=W,DST=_SETC_KJSTR_DIG1,L2=W;
	DATA_STD_SHN_MOV	SRC=_SET1_KJEND_DIG1,L1=W,DST=_SETC_KJEND_DIG1,L2=W;

;	-- 2014-05-30 --[ƒ⁄›ƒﬁ][îΩì]]
	DATA_STD_SHN_MOV	SRC=_SET1_KJSTR_DIG2,L1=W,DST=_SETC_KJSTR_DIG2,L2=W;
	DATA_STD_SHN_MOV	SRC=_SET1_KJEND_DIG2,L1=W,DST=_SETC_KJEND_DIG2,L2=W;

CB_COP_DT_MK2_200:

	SUB_END
	M_RTS

;	***************************
;	***	ë“ã@ì_+data	***
;	***************************
;	
_TAIKI_ADD;
	SUB_START
	MOV.L	#_SETX_UPAREA_DIG,R1					;2;âÒì]/îΩì]éûë“ã@ì_
	MOV.W	@R1,R0							;
	DIG_REGA_ADD_REGB_ANS_REGB REGA=R0,REGB=R2,WKREG=R1,LATE=3600	;R0+R2==>R2
	SUB_END
	M_RTS

;	***************************
;	***	2009-10-07â∫êUéq***
;	***************************
;	Input +R2
_NEG_TAIKI_SUB;
	SUB_START

	MOV.L	#_SETX_UPAREA_DIG,R1					;2;âÒì]/îΩì]éûë“ã@ì_
	MOV.W	@R1,R1							;
	MOV.W	#3600,R0						;
	SUB	R1,R0							;
	DIG_REGA_SUB_REGB_ANS_REGB REGA=R2,REGB=R0,WKREG=R1,LATE=3600	;R0=R0-R2
	MOV	R0,R2							;

	SUB_END
	M_RTS

;	***************************
;	***	2009-10-07â∫êUéq***
;	***************************
;	Input +R2
_NEG_TAIKI;
	SUB_START

	MOV.W	#3600,R0						;
	SUB	R2,R0							;
	MOV	R0,R2							;

	SUB_END
	M_RTS

;	*******************************************
;	***					***
;	***	ÉfÅ[É^ì¸ÇÍë÷Ç¶			***
;	***	2009-10-07	â∫êUéq		***
;	*******************************************
_SIG_AREA_DATA_CHG:
	SUB_START
	MOV.L	#_DNM_DIR_SET_FLG,R1			;
	MOV.W	@R1,R0					;
	MOV.L	#_DNM_DIR_FLG_OLD,R1			;
	MOV.W	@R1,R2					;
	MOV.W	R0,@R1					;
	XOR	R2,R0					;CHG DIRECTION
	TST	R0,R0					;
	TST_BIT_OF SIG_AREA_DATCHG050			;

	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_COP_DIG_SIG_FLG,LG=W,BIT=~(BIT2+BIT1),WKREG=R1				;BIT1:ê∂êMçÜ
	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_COP_CB_LD_MONI_SIG,LG=W,BIT=(~(BIT6+BIT5+BIT4+BIT3+BIT2+BIT1)),WKREG=R1	;2006-07-28

SIG_AREA_DATCHG050:

	MOV.L	#_SET1_MRTION_SEL1,R1			;
	MOV.W	@R1,R0					;
	TST	#_DMATH_CNTROT,R0			;
	TST_BIT_OF SIG_AREA_DATCHG100			;

	M_BRA	SIG_AREA_DATCHG500			;

SIG_AREA_DATCHG100:

	TST	#_DMATH_DNDRIV,R0			;
	TST_BIT_ON SIG_AREA_DATCHG120			;
	M_BRA	SIG_AREA_DATCHG200			;

SIG_AREA_DATCHG120:
	MOV.L	#_DNM_DIR_SET_FLG,R1			;
	MOV.W	@R1,R0					;
	TST	R0,R0					;
	TST_BIT_ON SIG_AREA_DATCHG150

;-------- âùòH-------
	DATA_STD_SHN_MOV	SRC=_SETX_KJSTR_DIG1,L1=W,DST=_SETC_KJSTR_DIG1,L2=W;
	DATA_STD_SHN_MOV	SRC=_SETX_KJEND_DIG1,L1=W,DST=_SETC_KJEND_DIG1,L2=W;
	DATA_STD_SHN_MOV	SRC=_WPARX_COP_DNDRV1_ZDG1,L1=W,DST=_WPAR_COP_ZDG1,L2=W
	DATA_STD_SHN_MOV	SRC=_WPARX_COP_DNDRV1_ZDG2,L1=W,DST=_WPAR_COP_ZDG2,L2=W
	DATA_STD_SHN_MOV	SRC=_WPARX_COP_DNDRV1_SDG1,L1=W,DST=_WPAR_COP_SDG1,L2=W
	DATA_STD_SHN_MOV	SRC=_WPARX_COP_DNDRV1_SDG2,L1=W,DST=_WPAR_COP_SDG2,L2=W

	DATA_STD_SHN_MOV	SRC=_SETX_KJSTR_DIG2,L1=W,DST=_SETC_KJSTR_DIG2,L2=W;
	DATA_STD_SHN_MOV	SRC=_SETX_KJEND_DIG2,L1=W,DST=_SETC_KJEND_DIG2,L2=W;
	M_BRA	SIG_AREA_DATCHG190


SIG_AREA_DATCHG150:
	DATA_STD_SHN_MOV	SRC=_SETY_KJSTR_DIG1,L1=W,DST=_SETC_KJSTR_DIG1,L2=W;
	DATA_STD_SHN_MOV	SRC=_SETY_KJEND_DIG1,L1=W,DST=_SETC_KJEND_DIG1,L2=W;
	DATA_STD_SHN_MOV	SRC=_WPARX_COP_DNDRV2_ZDG1,L1=W,DST=_WPAR_COP_ZDG1,L2=W
	DATA_STD_SHN_MOV	SRC=_WPARX_COP_DNDRV2_ZDG2,L1=W,DST=_WPAR_COP_ZDG2,L2=W
	DATA_STD_SHN_MOV	SRC=_WPARX_COP_DNDRV2_SDG1,L1=W,DST=_WPAR_COP_SDG1,L2=W
	DATA_STD_SHN_MOV	SRC=_WPARX_COP_DNDRV2_SDG2,L1=W,DST=_WPAR_COP_SDG2,L2=W

	DATA_STD_SHN_MOV	SRC=_SETY_KJSTR_DIG2,L1=W,DST=_SETC_KJSTR_DIG2,L2=W;
	DATA_STD_SHN_MOV	SRC=_SETY_KJEND_DIG2,L1=W,DST=_SETC_KJEND_DIG2,L2=W;
SIG_AREA_DATCHG190:
	M_BRA	SIG_AREA_DATCHG500			;

SIG_AREA_DATCHG200:


SIG_AREA_DATCHG500:



	SUB_END
	M_RTS

;	***************************
;	***			***
;	***************************
;
;	çHíˆ=1~MAX
;	0:èIóπÃ◊∏ﬁ,0:äJénÃ◊∏ﬁ
;
;	//å¥ì_ïúãAÇ≈ÇÕÇ‚ÇÁÇ»Ç¢
;	//RESETâèúéûÇ…≤∆º¨ŸèàóùÇçsÇ§:èIóπèÛë‘ BIT1=0(ª›Ãﬂÿ›∏ﬁäJénóLå¯ÇÃà”ñ°)
;	//
;
;	(1)∏◊Ø¡Ç…â^ì]äJén∂≥›¿ÇçÏÇÈ
;	(2)íÜíf
;	(3)äÆóπ
;
;	âÒì]
;	äJénèåè :â^ì]äJén+äpìxaÅ`äpìxb
;	èIóπèåè :äpìxBÇcwÇ≈â°êÿÇ¡ÇΩ

;	îΩì]
;	äJénèåè :â^ì]äJén+äpìxaÅ`äpìxb
;	èIóπèåè :ç≈èIçHíˆÇ≈äéÇ¬äpìxaÇÊÇËë“ã@ì_ë§Ç…Ç¢ÇÈ
;
;	=========================
;	COP_CB_LD_MONI_SIG;//â◊èdë™íËópêMçÜ 2003-01-31
;	BIT0=1 èÌéûON
;	BIT1=1 É[Éçí≤êÆäpìx
;	BIT2=1 â◊èdë™íËäpìx
;	BIT3=1 â◊èdë™íËäÆóπ
;	(BIT4)=1 æﬁ€í≤äÆóπ
;	BIT5=1 ACTIVE
;	*æﬁ€í≤êÆêMçÜÇÊÇËâ◊èdë™íËÇóDêÊÇ∑ÇÈÅB
;
;	[ƒ⁄›ƒﬁ,ç≈ëÂíl,ç≈è¨íl,ïùª›Ãﬂÿ›∏ﬁ]--->226.13
;	KJ_AREATRD_SIGÅF_KAJYUU_AREA2_SIGMAK
;		BIT0:1:éwíËà íuì‡
;		BIT1:1:ë™íËäJén(çsíˆä‹Çﬁ)Å`ÉTÉCÉNÉãèIóπ
;		BIT2:1:ë™íËèIóπ
;		BIT3
;		BIT4
;		BIT5:ë™íËäJén(BIT1Ç∆ìØéû)~ë™íËèIóπ()
;		BIT6:1:èIóπÅ`ÉTÉCÉNÉãèIóπ
;		BIT7
;
;	[â◊èdï‚ê≥]	----->226.5Çå©ÇÍÇŒÇÊÇ¢
;	_KJ_AREA_SIGÅFÅF_KAJYUU_AREA1_SIGMAK
;		BIT0:1:éwíËà íuì‡
;		BIT1:1:ë™íËäJén(çsíˆä‹Çﬁ)Å`ÉTÉCÉNÉãèIóπ
;		BIT2:1:ë™íËèIóπ
;		BIT3
;		BIT4
;		BIT5:ë™íËäJén(BIT1Ç∆ìØéû)~ë™íËèIóπ()
;		BIT6:1:èIóπÅ`ÉTÉCÉNÉãèIóπ
;		BIT7
;


	.EXPORT	_CB_COP_SIG_MAK	
_CB_COP_SIG_MAK:		;
	SUB_START

	FAR_JSR	#_SIG_AREA_DATA_CHG,R0	;[2009-10-07â∫êUéq]

	MOV.L	#_INC_ENC360,R1		;//360.0ìx(¥›∫∞¿ﬁÇÕï\é¶Ç∆ìØÇ∂)
	MOV.W	@R1,R2			;
	MOV	R2,R8			;R8:NOW
;;;ñ¢égóp	MOV.L	#_COP_ENC3600,R1	;
;;;ñ¢égóp	MOV.W	R2,@R1			;
	MOV.L	#_COP_OLD_ENC3600,R1	;
	MOV.W	@R1,R9			;R9:OLD
;;;;Ç±ÇÃ¿≤–›∏ﬁÇ≈ÿÃ⁄Øº≠ÇÕÇµÇ»Ç¢	MOV.W	R2,@R1			;

	MOV.L	#_SEQAB_DP_TOP+109*2,R1		;
	MOV.W	@R1,R0				;109.12
	MOV.W	#BIT12,R4			;
	TST	R4,R0				;
	TST_BIT_ON CB_COP_SIGMK_100		;

	MOV.W	#BIT0,R0			;
	MOV.L	#_COP_CB_LD_MONI_SIG,R1		;â◊èdë™íËÇµÇ»Ç¢
	MOV.W	R0,@R1				;BIT0=1(èÌéû)
	
	XOR	R0,R0				;
	MOV.L	#_COP_DIG_SIG_FLG,R1		;
	MOV.W	R0,@R1				;
	
;	------ 2006-07-28----
	XOR	R0,R0				;
	MOV.L	#_KJ_AREA_SIG,R1;
	MOV.W	R0,@R1				;
	MOV.L	#_KJ_AREA_BT0_OLD,R1		;2013-06-19
	MOV.W	R0,@R1				;

	MOV.L	#_KJ_AREATRD_SIG,R1
	MOV.W	R0,@R1				;
	MOV.L	#_KJ_AREATRD_SIG_OLD,R1;//2013-06-19
	MOV.W	R0,@R1				;

	M_BRA	CB_COP_SIGMK_EXT		;


;	*******************************************
;	***					***
;	***	â^ì]ÅEîÒâ^ì]Ç…ä÷ÇÌÇÁÇ∏çsÇ§	***
;	***					***
;	*******************************************
;	Z-DIG1:CWÇ≈â°êÿÇ¡ÇΩÇÁONorãÊä‘
;	Z-DIG2:CWÇ≈â°êÿÇ¡ÇΩÇÁOFF+äÆóπ
;	S-DIG1:CWÇ≈â°êÿÇ¡ÇΩÇÁONorãÊä‘(ë“ã@ì_)
;	S-DIG2:CWÇ≈â°êÿÇ¡ÇΩÇÁOFF+äÆóπ(ë“ã@ì_)
;	==========================
;	Z-DIG1:CWÇ≈â°êÿÇ¡ÇΩÇÁONorãÊä‘
;	Z-DIG2:CWÇ≈â°êÿÇ¡ÇΩÇÁOFF+äÆóπ
;	S-DIG1:CWÇ≈â°êÿÇ¡ÇΩÇÁONorãÊä‘(ë“ã@ì_+6ìxà»è„~180)
;	S-DIG2:CCWÇ≈â°êÿÇ¡ÇΩÇÁOFF+äÆóπ (ë“ã@ì_+5ìxà»â∫) SDIG2<SIDG1 (SDIG2Ç™ë“ã@ì_Ç…ãﬂÇ¢)
;
CB_COP_SIGMK_100:				;
	MOV.L	#_COP_DIG_SIG_FLG,R1				;
	MOV.W	@R1,R0						;
	TST	#BIT2,R0					;â◊èdë™íËíÜ
	TST_BIT_ON CB_COP_SIGMK_120				;ZEROí≤êÆêMçÜOFF

;	=============æﬁ€í≤êÆêMçÜçÏê¨====================
	MOV.L	#_WPAR_COP_ZDG1,R0							;ZEROí≤êÆäJénäpìx
	MOV.W	@R0,R1									;
	MOV.L	#_WPAR_COP_ZDG2,R0							;èIóπäpìx
	MOV.W	@R0,R3									;
	MOV	R8,R2									;
	DIG_AREA_CHK STREG=R1,EDREG=R3,PVREG=R2,ANSREG=R0				;
	CMP/EQ	#1,R0									;
	BF	CB_COP_SIGMK_120							;
	MEM1_BIT0_TO_BIT7_ORSET MEM=_COP_DIG_SIG_FLG,LG=W,BIT=BIT1,WKREG=R1		;îÕàÕì‡
	M_BRA	CB_COP_SIGMK_150							;

CB_COP_SIGMK_120:
	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_COP_DIG_SIG_FLG,LG=W,BIT=~BIT1,WKREG=R1		;BIT1:ê∂êMçÜ
CB_COP_SIGMK_150:									;


;	============ â◊èdêMçÜ ============
	MOV.L	#_SET1_MRTION_SEL1,R1		;
	MOV.W	@R1,R0				;
;;2009-10-07â∫êUéq	CMP/EQ	#_DMATH_CNTROT,R0		;DRIVE MATH òAë±âÒì]
;;2009-10-07â∫êUéq	BF	CB_COP_SIGMK_250		;îΩì]

	TST	#(_DMATH_CNTROT+_DMATH_DNDRIV),R0	;2009-10-06
	TST_BIT_OF CB_COP_SIGMK_250			;NO:îΩì]

;	=== âÒì] ==
	MOV.L	#_WPAR_COP_SDG1,R0			;â◊èdäJénäpìx
	MOV.W	@R0,R1					;
	MOV.L	#_WPAR_COP_SDG2,R0			;èIóπäpìx
	MOV.W	@R0,R3					;
	M_BRA	CB_COP_SIGMK_280			;

;	=== îΩì] ==
CB_COP_SIGMK_250:
	MOV.L	#_COP_DIG_SIG_FLG,R1				;
	MOV.W	@R1,R0						;
	TST	#BIT2,R0					;ON
	TST_BIT_ON CB_COP_SIGMK_270				;

	MOV.L	#_WPAR_COP_SDG1,R0			;â◊èdäJénäpìx
	MOV.W	@R0,R1					;
	MOV.W	#_UPDN_DIRJG_DIG,R3			;"äpìx(ãóó£Ç≈ÇÕÇ»Ç¢ Ç¬Ç‡ÇË)"
	M_BRA	CB_COP_SIGMK_280			;

CB_COP_SIGMK_270:
	MOV.L	#_WPAR_COP_SDG2,R0				;èIóπäpìx~ë“ã@ì_Ç»äpìxï€éù
	MOV.W	@R0,R1						;
	MOV.L	#_SETX_UPAREA_DIG,R0				;
	MOV.W	@R0,R3						;

CB_COP_SIGMK_280:
	MOV	R8,R2									;
	DIG_AREA_CHK STREG=R1,EDREG=R3,PVREG=R2,ANSREG=R0				;
	CMP/EQ	#1,R0									;
	BF	CB_COP_SIGMK_290							;îÕàÕäO
	MEM1_BIT0_TO_BIT7_ORSET MEM=_COP_DIG_SIG_FLG,LG=W,BIT=(BIT2),WKREG=R1		;â◊èdSET
	M_BRA	CB_COP_SIGMK_300

CB_COP_SIGMK_290:
	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_COP_DIG_SIG_FLG,LG=W,BIT=(~BIT2),WKREG=R1		;â◊èd∏ÿ±
CB_COP_SIGMK_300:


;	===== èoóÕêMçÜçÏê¨ ======
	MOV.L	#_COP_DIG_SIG_FLG,R1	;
	MOV.W	@R1,R0			;
	TST	#BIT1,R0		;
	TST_BIT_ON CB_COP_SIGMK_550	;

	MOV.L	#_COP_CB_LD_MONI_SIG,R1	;
	MOV.W	@R1,R0			;
	TST	#BIT1,R0		;
	TST_BIT_OF CB_COP_SIGMK_520	;
	MEM1_BIT0_TO_BIT7_ORSET MEM=_COP_CB_LD_MONI_SIG,LG=W,BIT=(BIT4),WKREG=R1	;æﬁ€äÆóπ
CB_COP_SIGMK_520:
	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_COP_CB_LD_MONI_SIG,LG=W,BIT=(~BIT1),WKREG=R1	;æﬁ€∏ÿ±
	M_BRA	CB_COP_SIGMK_580	;

CB_COP_SIGMK_550:
;;2006-07-28	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_COP_CB_LD_MONI_SIG,LG=W,BIT=(~(BIT4+BIT3+BIT2)),WKREG=R1	;æﬁ€äÆóπ∏ÿ±
	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_COP_CB_LD_MONI_SIG,LG=W,BIT=(~(BIT6+BIT5+BIT4+BIT3+BIT2)),WKREG=R1	;2006-07-28
												;æﬁ€äÆóπ∏ÿ±
												;â◊èdë™íËíÜ∏ÿ±
												;â◊èdäÆóπ∏ÿ±
	MEM1_BIT0_TO_BIT7_ORSET MEM=_COP_CB_LD_MONI_SIG,LG=W,BIT=(BIT1),WKREG=R1		;æﬁ€íÜ

;	------¢æﬁ€í≤êÆíÜ£----
	XOR	R0,R0				;
	MOV.L	#_KJ_AREA_SIG,R1		;
	MOV.W	R0,@R1				;
	MOV.L	#_KJ_AREA_BT0_OLD,R1		;2013-06-19
	MOV.W	R0,@R1				;
	MOV.L	#_KJ_AREATRD_SIG,R1
	MOV.W	R0,@R1				;
	MOV.L	#_KJ_AREATRD_SIG_OLD,R1		;//2013-06-19
	MOV.W	R0,@R1				;

;	-------------- â◊èdëOâÒ√ﬁ∞¿∏ÿ±----------
	MOV.B	#BIT0,R0			;
	MOV.L	#_ATOB_KJYUALL_SMPCLR,R1	;∏ÿ±ÇµÇÎ
	MOV.W	R0,@R1				;
	MOV.L	#_ATOB_KJYUTRD_SMPCLR,R1	;∏ÿ±ÇµÇÎ
	MOV.W	R0,@R1				;
;	-------------------------------------------




CB_COP_SIGMK_580:


	MOV.L	#_COP_DIG_SIG_FLG,R1						;
	MOV.W	@R1,R0								;
	TST	#BIT2,R0							;
	TST_BIT_ON CB_COP_SIGMK_650						;

	MOV.L	#_COP_CB_LD_MONI_SIG,R1							;
	MOV.W	@R1,R0									;
	TST	#BIT2,R0								;â◊èdë™íËíÜÇæÇ¡ÇΩÇ©ÅH
	TST_BIT_OF CB_COP_SIGMK_620							;NO
	MEM1_BIT0_TO_BIT7_ORSET MEM=_COP_CB_LD_MONI_SIG,LG=W,BIT=(BIT3),WKREG=R1	;â◊èdë™íËäÆóπ
CB_COP_SIGMK_620:
	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_COP_CB_LD_MONI_SIG,LG=W,BIT=(~BIT2),WKREG=R1	;â◊èdë™íË∏ÿ±
	M_BRA	CB_COP_SIGMK_680	;

CB_COP_SIGMK_650:
	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_COP_CB_LD_MONI_SIG,LG=W,BIT=(~BIT3),WKREG=R1	;â◊èdäÆóπ∏ÿ±
	MEM1_BIT0_TO_BIT7_ORSET MEM=_COP_CB_LD_MONI_SIG,LG=W,BIT=(BIT2),WKREG=R1	;â◊èdë™íËíÜ
CB_COP_SIGMK_680:

;	------------ 2014-05-30--------------
	FAR_JSR	#_KAJYUU_AREA2_SIGMAK,R0		;

;	=========2006-07-28 BIT4,5 REFLASH========
	FAR_JSR	#_KAJYUU_AREA1_SIGMAK,R0		;


	MOV.W	#(BIT6+BIT5),R4			;
	MOV.L	#_KJ_AREA_SIG,R1		;
	MOV.W	@R1,R0				;
	AND	#(BIT6+BIT5),R0			;
	NOT	R4,R4
	MOV.L	#_COP_CB_LD_MONI_SIG,R1		;
	MOV.W	@R1,R2				;
	AND	R4,R2				;
	OR	R0,R2				;
	MOV.W	R2,@R1				;


;	----------- √ﬁ ﬁØ∏ópBIT8~BIT15(ƒ⁄›ƒﬁ--------
	MOV.L	#_KJ_AREATRD_SIG,R1		;
	MOV.W	@R1,R0				;
	SHLL8	R0				;
	EXTU.B	R2,R2				;
	OR	R0,R2				;

	MOV.L	#(_SQ_CBWK_TOP+26*2),R1		;_SQCB226.7~0=COP_CB_LD_MONI_SIG
	MOV.W	R2,@R1				;


;	---------2014-02-05 ç≈è¨íl,ç≈ëÂíl,ïùª›Ãﬂÿ›∏ﬁ(â◊èdåvÇ∆ìØÇ∂ãÊä‘ 60~270ìx)--------------
	MOV.L	#_COP_CB_LD_MONI_SIG,R1		;
	MOV.W	@R1,R0				;
	TST	#BIT2,R0			;
	TST_BIT_ON KAJYUU_MIN_SMP100		;[ëSëÃÇÃë™íËäJénéwóﬂíÜÅ@29~238ìx]

	MOV.L	#_ATOB_KJYUALL_SMPSTART,R1	;ª›Ãﬂÿ›∏ﬁéwóﬂOFF
	MOV.W	@R1,R2				;
	TST	R2,R2
	TST_BIT_OF KAJYUU_MIN_SMP250		;

	XOR	R2,R2				;
	MOV.L	#_ATOB_KJYUALL_SMPSTART,R1	;ª›Ãﬂÿ›∏ﬁéwóﬂOFF
	MOV.W	R2,@R1				;
	MEM1_BIT0_TO_BIT7_ORSET MEM=_KJYU_CMP_CMD,LG=W,BIT=BIT1,WKREG=R1	;BIT1èIóπÇµÇΩèuä‘
	M_BRA	KAJYUU_MIN_SMP250		;

KAJYUU_MIN_SMP100

	MOV.L	#_ATOB_KJYUALL_SMPSTART,R1		;ª›Ãﬂÿ›∏ﬁéwóﬂ
	MOV.W	@R1,R2				;
	TST	R2,R2				;à»ëOÇÕOFFÇæÇ¡ÇΩÇ©
	TST_BIT_ON KAJYUU_MIN_SMP200		;NO ON


	MOV.W	#BIT0,R3			;
	MOV.L	#_ATOB_KJYUALL_SMPCLR,R4	;∏ÿ±ÇµÇÎ
	MOV.W	R3,@R4				;

	MOV.W	#BIT0,R2			;ë™íËäJénÇµÇÎ
	MOV.W	R2,@R1				;
	M_BRA	CB_COP_SIGMK_EXT		;

;
KAJYUU_MIN_SMP200
	MEM1_BIT0_TO_BIT7_ORSET MEM=_KJYU_CMP_CMD,LG=W,BIT=BIT0,WKREG=R1	;BIT0 î‰ärãÊä‘




KAJYUU_MIN_SMP250:
CB_COP_SIGMK_EXT:


	MOV.L	#_INC_ENC360,R1		;//360.0ìx(¥›∫∞¿ﬁÇÕï\é¶Ç∆ìØÇ∂)
	MOV.W	@R1,R2			;
	MOV.L	#_COP_OLD_ENC3600,R1	;
	MOV.W	R2,@R1			;


	FAR_JSR	#_KAJYUU_DEBUG_ANACHG,R0	;Ç†Ç¡ÇƒÇ‡à´Ç≥ÇÕÇµÇ»Ç¢

	FAR_JSR	#_KAJYUU_OVER_LOW_CHK,R0	;


	SUB_END
	M_RTS


;	***************************************************
;	***						***
;	***	ñ{ìñÇÕçHíˆÇ‡ä«óùÇµÇ»Ç¢Ç∆Ç¢ÇØÇ»Ç¢	***
;	***						***
;	***************************************************
;	BIT0=1 AREAì‡
;	BIT1=1 STARTÇ…ì¸Ç¡ÇΩÇ‹ÇΩÇÕçHíˆÇ™í¥Ç¶ÇΩ
;	BIT2=1 ENDÇí¥Ç¶ÇΩÇ‹ÇΩÇÕîÕàÕäOÇ…Ç»Ç¡ÇΩ
;	CLR çHíˆMAX~çHíˆ1Ç…Ç»Ç¡ÇΩ
;
;	[â◊èdï‚ê≥ãÊä‘]
;
_KAJYUU_AREA1_SIGMAK:
	SUB_START
	MOV.L	#_SETC_KJSTR_DIG1,R4						;[2009-10-07â∫êUéq]
	MOV.W	@R4,R1								;
	MOV.L	#_INC_ENC360,R4							;
	MOV.W	@R4,R2								;

	MOV.L	#_SETC_KJEND_DIG1,R4						;[2009-10-07â∫êUéq]
	MOV.W	@R4,R3			
	DIG_AREA_CHK STREG=R1,EDREG=R3,PVREG=R2,ANSREG=R0			;
	CMP/EQ	#1,R0								;
	BF	KAYJUU_AREA1SIGMK050						;
	MEM1_BIT0_TO_BIT7_ORSET MEM=_KJ_AREA_SIG,LG=W,BIT=(BIT0),WKREG=R1	;AREA-ON
	M_BRA	KAYJUU_AREA1SIGMK090						;
KAYJUU_AREA1SIGMK050:								;
	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_KJ_AREA_SIG,LG=W,BIT=(~BIT0),WKREG=R1	;
KAYJUU_AREA1SIGMK090:								;


;	-------- äJénèåè----
	MOV.L	#_KJ_AREA_SIG,R1						;
	MOV.W	@R1,R0								;
	TST	#BIT1,R0							;START ON?
	TST_BIT_ON KAYJUU_AREA1SIGMK200						;

	MOV.L	#_SET1_KJSTR_STEP1,R1						;
	MOV.W	@R1,R0								;
	TST	R0,R0								;
	TST_BIT_OF KAYJUU_AREA1SIGMK130						;0:POS

	MOV.L	#_INT_POS_CTL_STEP,R1						;
	MOV.W	@R1,R2								;
	TST	R2,R2								;
	TST_BIT_OF KAYJUU_AREA1SIGMK190						;çHíˆ=0
	
	CMP/HI	R0,R2								;çHíˆÇí¥Ç¶ÇΩ
	BT	KAYJUU_AREA1SIGMK150						;
	CMP/EQ	R0,R2								;
	BF	KAYJUU_AREA1SIGMK190						;

KAYJUU_AREA1SIGMK130:								;
	MOV.L	#_KJ_AREA_SIG,R1						;
	MOV.W	@R1,R0								;
	TST	#BIT0,R0							;
	TST_BIT_OF KAYJUU_AREA1SIGMK190						;
KAYJUU_AREA1SIGMK150:								;
	MEM1_BIT0_TO_BIT7_ORSET MEM=_KJ_AREA_SIG,LG=W,BIT=(BIT5+BIT1),WKREG=R1	;AREA-ON
KAYJUU_AREA1SIGMK190:								;
	M_BRA	KAYJUU_AREA1SIGMK900						;

KAYJUU_AREA1SIGMK200:
;	-------- èIóπèåè----
	MOV.L	#_KJ_AREA_SIG,R1						;
	MOV.W	@R1,R0								;
	TST	#BIT2,R0							;START ON?
	TST_BIT_ON KAYJUU_AREA1SIGMK290						;(ë™íËèIóπ,éüÇÃª≤∏Ÿë“Çø)


;;;;	MOV.L	#_SET1_KJEND_STEP1,R1						;
;;;;	MOV.W	@R1,R0								;
;;;;	TST	R0,R0								;
;;;;	TST_BIT_ON KAYJUU_AREA1SIGMK220						;POSà»äO
;;;;
;;;;
;;;;	MOV.L	#_SET1_MRTION_SEL1,R4						;
;;;;	MOV.W	@R4,R0								;
;;;;	TST	#(_DMATH_CNTROT+_DMATH_DNDRIV),R0				;âÒì]orÇ”ÇËÇ±Ç©
;;;;	TST_BIT_OF KAYJUU_AREA1SIGMK240						;îΩì]
;;;;
;;;;;	--------âÒì]Ç‹ÇΩÇÕÇ”ÇËÇ±ÇÃà íuÉJÉÄ--------------
;;;;	MOV.L	#_KJ_AREA_SIG,R1		;
;;;;	MOV.W	@R1,R0				;
;;;;	TST	#BIT0,R0			;à íuîÕàÕ?
;;;;	TST_BIT_OF KAYJUU_AREA1SIGMK250		;à íuîÕàÕÇ©ÇÁèoÇΩCLR
;;;;	M_BRA	KAYJUU_AREA1SIGMK290		;


;----------çHíˆéwíË-------------
KAYJUU_AREA1SIGMK220:
	MOV.L	#_SET1_KJEND_STEP1,R1						;
	MOV.W	@R1,R0								;
	TST	R0,R0								;
	TST_BIT_OF KAYJUU_AREA1SIGMK230						;

	MOV.L	#_INT_POS_CTL_STEP,R1						;
	MOV.W	@R1,R2								;
	TST	R2,R2								;
	TST_BIT_OF KAYJUU_AREA1SIGMK290						;çHíˆ=0

	CMP/HI	R0,R2								;çHíˆÇí¥Ç¶ÇΩ
	BT	KAYJUU_AREA1SIGMK250						;èIóπ

	CMP/EQ	R0,R2								;
	BF	KAYJUU_AREA1SIGMK290						;

KAYJUU_AREA1SIGMK230:
	MOV.L	#_SET1_MRTION_SEL1,R4				;
	MOV.W	@R4,R0						;
	TST	#(_DMATH_CNTROT+_DMATH_DNDRIV),R0		;âÒì]orÇ”ÇËÇ±Ç©
	TST_BIT_OF KAYJUU_AREA1SIGMK240				;îΩì]
	NOP
KAYJUU_AREA1SIGMK240:						;
;	-------- à íuÉJÉÄÇ‹ÇΩÇÕçHíˆÉJÉÄÇÃåªçsçHíˆ-------------
	MOV.L	#_KJ_AREA_SIG,R1		;
	MOV.W	@R1,R0				;
	TST	#BIT0,R0			;
	TST_BIT_ON KAYJUU_AREA1SIGMK290		;ONÇµÇƒÇ¢ÇÈ

	MOV.L	#_KJ_AREA_BT0_OLD,R1		;//2013-06-19
	MOV.W	@R1,R0				;
	TST	#BIT0,R0			;ONÇµÇƒÇ¢ÇΩ
	TST_BIT_ON KAYJUU_AREA1SIGMK250		;
	M_BRA	KAYJUU_AREA1SIGMK290		;

;	------------îΩì]ÇÃèÍçáÇæÇØ----------------
;;;;KAYJUU_AREA1SIGMK240:
;;;;
;;;;	MOV.L	#_COP_OLD_ENC3600,R0			;
;;;;	MOV.W	@R0,R4					;
;;;;	MOV.L	#_SETC_KJEND_DIG1,R0			;ÅEÅEÅEÅE
;;;;	MOV.W	@R0,R2					;
;;;;	MOV.L	#_INC_ENC360,R0				;ãtâÒì]Ç≈â°êÿÇ¡ÇΩÇÁ;
;;;;	MOV.W	@R0,R1			
;;;;
;;;;	DIG_AREA_CHK STREG=R1,EDREG=R3,PVREG=R2,ANSREG=R0			;
;;;;	CMP/EQ	#1,R0								;
;;;;	BT	KAYJUU_AREA1SIGMK250						;
;;;;	M_BRA	KAYJUU_AREA1SIGMK290						;
KAYJUU_AREA1SIGMK250:
	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_KJ_AREA_SIG,LG=W,BIT=(~BIT5),WKREG=R1	;
	MEM1_BIT0_TO_BIT7_ORSET MEM=_KJ_AREA_SIG,LG=W,BIT=(BIT6+BIT2),WKREG=R1	;END SET
KAYJUU_AREA1SIGMK290:								;
	NOP
KAYJUU_AREA1SIGMK900				;

KAYJUU_AREA1SIGMKEXT
	MOV.L	#_KJ_AREA_SIG,R1						;
	MOV.W	@R1,R0								;
	MOV.L	#_KJ_AREA_BT0_OLD,R1		;//2013-06-19
	MOV.W	R0,@R1				;


	SUB_END
	M_RTS








;	***************************************************
;	***						***
;	***	ñ{ìñÇÕçHíˆÇ‡ä«óùÇµÇ»Ç¢Ç∆Ç¢ÇØÇ»Ç¢	***
;	***						***
;	***************************************************
;	BIT0=1 AREAì‡
;	BIT1=1 STARTÇ…ì¸Ç¡ÇΩÇ‹ÇΩÇÕçHíˆÇ™í¥Ç¶ÇΩ
;	BIT2=1 ENDÇí¥Ç¶ÇΩÇ‹ÇΩÇÕîÕàÕäOÇ…Ç»Ç¡ÇΩ
;	CLR çHíˆMAX~çHíˆ1Ç…Ç»Ç¡ÇΩ
;
;	[ÉgÉåÉìÉhãÊä‘]
;
_KAJYUU_AREA2_SIGMAK:
	SUB_START
	MOV.L	#_SETC_KJSTR_DIG2,R4						;[2009-10-07â∫êUéq]
	MOV.W	@R4,R1								;
	MOV.L	#_INC_ENC360,R4							;
	MOV.W	@R4,R2								;

	MOV.L	#_SETC_KJEND_DIG2,R4						;[2009-10-07â∫êUéq]
	MOV.W	@R4,R3			
	DIG_AREA_CHK STREG=R1,EDREG=R3,PVREG=R2,ANSREG=R0			;
	CMP/EQ	#1,R0								;
	BF	KAYJUU_AREA2SIGMK050						;
	MEM1_BIT0_TO_BIT7_ORSET MEM=_KJ_AREATRD_SIG,LG=W,BIT=(BIT0),WKREG=R1	;AREA-ON
	M_BRA	KAYJUU_AREA2SIGMK090						;
KAYJUU_AREA2SIGMK050:								;
	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_KJ_AREATRD_SIG,LG=W,BIT=(~BIT0),WKREG=R1	;
KAYJUU_AREA2SIGMK090:								;


;	-------- äJénèåè----
	MOV.L	#_KJ_AREATRD_SIG,R1						;
	MOV.W	@R1,R0								;
	TST	#BIT1,R0							;START ON?
	TST_BIT_ON KAYJUU_AREA2SIGMK200						;

	MOV.L	#_SET1_KAJAREA_SNO,R1						;äJénçHíˆ
	MOV.W	@R1,R0								;
	TST	R0,R0								;
	TST_BIT_OF KAYJUU_AREA2SIGMK130						;0:POS

	MOV.L	#_INT_POS_CTL_STEP,R1						;
	MOV.W	@R1,R2								;
	TST	R2,R2								;
	TST_BIT_OF KAYJUU_AREA2SIGMK190						;çHíˆ=0

	CMP/HI	R0,R2								;çHíˆÇí¥Ç¶ÇΩ
	BT	KAYJUU_AREA2SIGMK150						;
	CMP/EQ	R0,R2								;
	BF	KAYJUU_AREA2SIGMK190						;

KAYJUU_AREA2SIGMK130:									;
	MOV.L	#_KJ_AREATRD_SIG,R1							;
	MOV.W	@R1,R0									;
	TST	#BIT0,R0								;
	TST_BIT_OF KAYJUU_AREA2SIGMK190							;
KAYJUU_AREA2SIGMK150:									;
	MEM1_BIT0_TO_BIT7_ORSET MEM=_KJ_AREATRD_SIG,LG=W,BIT=(BIT5+BIT1),WKREG=R1	;BIT1,BIT5:çHíˆÇ≈äéÇ¬äpìxON
KAYJUU_AREA2SIGMK190:									;
	M_BRA	KAYJUU_AREA2SIGMK900							;

KAYJUU_AREA2SIGMK200:
;	-------- èIóπèåè----
	MOV.L	#_KJ_AREATRD_SIG,R1						;
	MOV.W	@R1,R0								;
	TST	#BIT2,R0							;START ON?
	TST_BIT_ON KAYJUU_AREA2SIGMK290						;èIóπÅ@éüÇÃÉTÉCÉNÉãë“Çø


;----------çHíˆéwíË-------------
KAYJUU_AREA2SIGMK220:
	MOV.L	#_SET1_KAJAREA_ENO,R1						;
	MOV.W	@R1,R0								;
	TST	R0,R0								;
	TST_BIT_OF KAYJUU_AREA2SIGMK230						;

	MOV.L	#_INT_POS_CTL_STEP,R1						;
	MOV.W	@R1,R2								;
	TST	R2,R2								;
	TST_BIT_OF KAYJUU_AREA2SIGMK290						;çHíˆ=0
	
	CMP/HI	R0,R2								;çHíˆÇí¥Ç¶ÇΩ
	BT	KAYJUU_AREA2SIGMK250						;CLR
	CMP/EQ	R0,R2								;
	BF	KAYJUU_AREA2SIGMK290						;

KAYJUU_AREA2SIGMK230:
	MOV.L	#_SET1_MRTION_SEL1,R4				;
	MOV.W	@R4,R0						;
	TST	#(_DMATH_CNTROT+_DMATH_DNDRIV),R0		;âÒì]orÇ”ÇËÇ±Ç©
	TST_BIT_OF KAYJUU_AREA2SIGMK240				;îΩì]
	NOP
KAYJUU_AREA2SIGMK240:						;
;	-------- à íuÉJÉÄÇ‹ÇΩÇÕçHíˆÉJÉÄÇÃåªçsçHíˆ-------------
	MOV.L	#_KJ_AREATRD_SIG,R1		;
	MOV.W	@R1,R0				;
	TST	#BIT0,R0			;
	TST_BIT_ON KAYJUU_AREA2SIGMK290		;ONÇµÇƒÇ¢ÇÈ

	MOV.L	#_KJ_AREATRD_SIG_OLD,R1		;//2013-06-19
	MOV.W	@R1,R0				;
	TST	#BIT0,R0			;ONÇµÇƒÇ¢ÇΩ
	TST_BIT_ON KAYJUU_AREA2SIGMK250		;
	M_BRA	KAYJUU_AREA2SIGMK290		;

KAYJUU_AREA2SIGMK250:
	MEM1_BIT0_TO_BIT7_ANDCLR MEM=_KJ_AREATRD_SIG,LG=W,BIT=(~BIT5),WKREG=R1	;
	MEM1_BIT0_TO_BIT7_ORSET MEM=_KJ_AREATRD_SIG,LG=W,BIT=(BIT6+BIT2),WKREG=R1	;END SET
KAYJUU_AREA2SIGMK290:								;
	NOP
KAYJUU_AREA2SIGMK900				;

KAYJUU_AREA2SIGMKEXT
	MOV.L	#_KJ_AREATRD_SIG,R1						;
	MOV.W	@R1,R0								;
	MOV.L	#_KJ_AREATRD_SIG_OLD,R1		;//2013-06-19
	MOV.W	R0,@R1				;



;	---------2014-02-05 ç≈è¨íl,ç≈ëÂíl,ïùª›Ãﬂÿ›∏ﬁ(â◊èdåvÇ∆ìØÇ∂ãÊä‘ 60~270ìx)--------------
	MOV.L	#_KJ_AREATRD_SIG,R1		;
	MOV.W	@R1,R0				;
	TST	#BIT2,R0			;èIóπ?
	TST_BIT_ON KAYJUU_AREA2SMP050		;
	TST	#BIT1,R0			;
	TST_BIT_ON KAYJUU_AREA2SMP100		;äJén? YES JUMP

KAYJUU_AREA2SMP050
	XOR	R2,R2				;
	MOV.L	#_ATOB_KJYUTRD_SMPSTART,R1	;ª›Ãﬂÿ›∏ﬁéwóﬂOFF
	MOV.W	R2,@R1				;
	M_BRA	KAYJUU_AREA2SMP200		;

KAYJUU_AREA2SMP100
	MOV.L	#_ATOB_KJYUTRD_SMPSTART,R1		;ª›Ãﬂÿ›∏ﬁéwóﬂ
	MOV.W	@R1,R2				;
	TST	R2,R2				;à»ëOÇÕOFFÇæÇ¡ÇΩÇ©
	TST_BIT_ON KAYJUU_AREA2SMP200		;NO ON


	MOV.W	#BIT0,R3			;
	MOV.L	#_ATOB_KJYUTRD_SMPCLR,R4		;∏ÿ±ÇµÇÎ
	MOV.W	R3,@R4				;

	MOV.W	#BIT0,R2			;ë™íËäJénÇµÇÎ
	MOV.W	R2,@R1				;

KAYJUU_AREA2SMP200

	SUB_END
	M_RTS


;	*******************************************
;	***					***
;	***					***
;	***					***
;	*******************************************
;	ëSëÃãÊä‘Ç…ëŒÇ∑ÇÈî‰är
;	ç≈ëÂílÅAç≈è¨íl(œ≤≈Ωç≈ëÂ),ïùÇ…ëŒÇµÇƒî‰ärÇçsÇ§ÅB
;	ç≈ëÂílÇÃèÍçáÇÃµ∞ ﬁ€∞ƒﬁ,€±ÿ–ØƒÇÕâ◊èdåvÇ™çsÇ§.
;	ç≈è¨íl(œ≤≈Ωç≈ëÂ),ïùílÇ…ëŒÇµÇƒçsÇ§ÅB
;	SW=0000,0001(ç≈ëÂílî‰är)
;	SW=0000,0010(ç≈è¨ílî‰är)
;	SW=0000,0100(ïùî‰är)
;
;	.GLOBAL	_KJYU_CMP_CMD;		//BIT0=1 :µ∞ ﬁ€∞ƒﬁî‰är(ãÊä‘ì‡) BIT1=1€±ÿ–Øƒî‰är(ãÊä‘âﬂ)
;	.GLOBAL	_KJYU_CMP_SELSW1;	//BIT0,BIT1(),BIT2()
;	.GLOBAL	_KJYU_CMP_SELSW2;	//BIT0,BIT1(),BIT2()
;	.GLOBAL	_KJYU_CMP_SEQMINS;	//ç≈è¨íl(œ≤≈Ωë§) µ∞ ﬁBIT0(ç∂),BIT1(âE),BIT2(çáåv)
;	.GLOBAL	_KJYU_CMP_SEQHABA;	//ïù             µ∞ ﬁBIT0(ç∂),BIT1(âE),BIT2(çáåv)


_KAJYUU_OVER_LOW_CHK
	SUB_START
	MOV.L	#_di1_cb_ctl1_dt,R1			;⁄ÕﬁŸÇ…ïœçX
	MOV.W	@R1,R0					;
	MOV.W	#_W1RST,R4				;ÿæØƒñt
	TST	R4,R0					;
	TST_BIT_OF KAJYUU_OVER_LOWCHK100		;
	XOR	R0,R0					;ÿæØƒ:º∞π›Ω∏ÿ±
	MOV.L	#_KJYU_CMP_SEQMINS,R1			;
	MOV.W	R0,@R1					;
	MOV.L	#_KJYU_CMP_SEQHABA,R1			;
	MOV.W	R0,@R1					;
	MOV.L	#_KJYU_CMP_CMD,R1			;
	MOV.W	R0,@R1					;
	M_BRA	KAJYUU_OVER_LOWCHKEXT			;

KAJYUU_OVER_LOWCHK100

	MOV.L	#_KJYU_CMP_CMD,R5			;
	MOV.W	@R5,R0					;
	TST	#BIT0,R0				;
	TST_BIT_OF KAJYUU_OVER_LOWCHK200		;BIT0=1:µ∞ ﬁ€∞ƒﬁãÊä‘
	AND	#LOW ~BIT0,R0				;
	MOV.W	R0,@R5					;


	FAR_JSR	#_KAJYU_OVERLOAD_CHK,R0			;


KAJYUU_OVER_LOWCHK200

	MOV.L	#_KJYU_CMP_CMD,R5			;
	MOV.W	@R5,R0					;
	TST	#BIT1,R0				;
	TST_BIT_OF KAJYUU_OVER_LOWCHK300		;BIT1=1:€±ÿ–ØƒãÊä‘
	AND	#LOW ~BIT1,R0				;
	MOV.W	R0,@R5					;


	FAR_JSR	#_KAJYU_LOWLIMIT_CHK,R0			;


KAJYUU_OVER_LOWCHK300
KAJYUU_OVER_LOWCHKEXT

	MOV.L	#_KJYU_CMP_SEQMINS,R1		;î‰ärêMçÜæØƒ
	MOV.W	@R1,R0				;
	EXTU.W	R0,R0
	MOV.L	#_KJYU_CMP_SEQHABA,R1		;
	MOV.W	@R1,R2				;
	SHLL8	R2
	OR	R2,R0
	MOV.L	#_SQ_CBWK_TOP+_WKSQCB250,R1	;250
	MOV.W	R0,@R1				;



	SUB_END
	M_RTS


;_BTOA_LFT_MAX		.SRES	4	;(Ç±ÇÍÇÕégópÇµÇ»Ç¢ó\íË,â◊èdåvÇ™Ç‚Ç¡ÇƒÇ¢ÇÈÇ©ÇÁ)
;_BTOA_LFT_HAB		.SRES	4	;

;_BTOA_RIH_MAX		.SRES	4	;(Ç±ÇÍÇÕégópÇµÇ»Ç¢ó\íË,â◊èdåvÇ™Ç‚Ç¡ÇƒÇ¢ÇÈÇ©ÇÁ)
;_BTOA_RIH_HAB		.SRES	4	;

;_BTOA_TTL_MAX		.SRES	4	;(Ç±ÇÍÇÕégópÇµÇ»Ç¢ó\íË,â◊èdåvÇ™Ç‚Ç¡ÇƒÇ¢ÇÈÇ©ÇÁ)
;_BTOA_TTL_HAB		.SRES	4	;

;	-------------- ç≈è¨(œ≤≈Ωç≈ëÂ)ëIëéû µ∞ ﬁ€∞ƒﬁ,€±ÿ–Øƒ ç∂,çáåv,âE
	.IMPORT		_SVP_OVERE1_A27			; â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇP Å@Åiç≈è¨ílÅj
	.IMPORT		_SVP_ROALM1_A27			; â◊èdåvÅ@ÉçÉAÅ[ÉäÉbÉ~ÉgÇP  Å@Åiç≈è¨ílÅj
	.IMPORT		_SVP_OVERE2_A27			; â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇQ  Å@Åiç≈è¨ílÅj
	.IMPORT		_SVP_ROALM2_A27			; â◊èdåvÅ@ÉçÉAÅ[ÉäÉbÉ~ÉgÇQ  Å@Åiç≈è¨ílÅj
	.IMPORT		_SVP_OVERE3_A27			; â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇR  Å@Åiç≈è¨ílÅj
	.IMPORT		_SVP_ROALM3_A27			; â◊èdåvÅ@ÉçÉAÅ[ÉäÉbÉ~ÉgÇR  Å@Åiç≈è¨ílÅj

;	-------------- êUïùëIëéû µ∞ ﬁ€∞ƒﬁ,€±ÿ–Øƒ ç∂,çáåv,âE
	.IMPORT		_SVP_OVERE1_A28			; â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇP Å@ÅiêUïùÅj
	.IMPORT		_SVP_ROALM1_A28			; â◊èdåvÅ@ÉçÉAÅ[ÉäÉbÉ~ÉgÇP  Å@ÅiêUïùÅj
	.IMPORT		_SVP_OVERE2_A28			; â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇQ  Å@ÅiêUïùÅj
	.IMPORT		_SVP_ROALM2_A28			; â◊èdåvÅ@ÉçÉAÅ[ÉäÉbÉ~ÉgÇQ  Å@ÅiêUïùÅj
	.IMPORT		_SVP_OVERE3_A28			; â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇR  Å@ÅiêUïùÅj
	.IMPORT		_SVP_ROALM3_A28			; â◊èdåvÅ@ÉçÉAÅ[ÉäÉbÉ~ÉgÇR  Å@ÅiêUïùÅj

;	--------ëSãÊä‘(µ∞ ﬁ€∞ƒﬁ,€ÿ–Øƒóp)-------------------
	.IMPORT		_BTOA_LFT_MAX		;(Ç±ÇÍÇÕégópÇµÇ»Ç¢ó\íË,â◊èdåvÇ™Ç‚Ç¡ÇƒÇ¢ÇÈÇ©ÇÁ)
	.IMPORT		_BTOA_LFT_MIN		;
	.IMPORT		_BTOA_LFT_HAB		;

	.IMPORT		_BTOA_RIH_MAX		;(Ç±ÇÍÇÕégópÇµÇ»Ç¢ó\íË,â◊èdåvÇ™Ç‚Ç¡ÇƒÇ¢ÇÈÇ©ÇÁ)
	.IMPORT		_BTOA_RIH_MIN		;
	.IMPORT		_BTOA_RIH_HAB		;

	.IMPORT		_BTOA_TTL_MAX		;(Ç±ÇÍÇÕégópÇµÇ»Ç¢ó\íË,â◊èdåvÇ™Ç‚Ç¡ÇƒÇ¢ÇÈÇ©ÇÁ)
	.IMPORT		_BTOA_TTL_MIN		;
	.IMPORT		_BTOA_TTL_HAB		;


;	*******************************************
;	***					***
;	***	µ∞ ﬁ€∞ƒﬁ			***
;	***					***
;	*******************************************
_KAJYU_OVERLOAD_CHK:
	SUB_START


;;	MOV.L	#_KJYU_CMP_SELSW1,R1		;
	MOV.L	#_CB_SEQ_SW_SEL058,R1		;00
	MOV.W	@R1,R0				;
	SHLR8	R0				;BIT9,BIT8=00,01,10
	AND	#(BIT1+BIT0),R0			;

	CMP/EQ	#BIT0,R0			;ç≈è¨â◊èd(œ≤≈Ωç≈ëÂ?)
	BT	KAJYU_OVERLOADCK_100		;
	CMP/EQ	#BIT1,R0			;ïù?
	BT	KAJYU_OVERLOADCK_200		;

;	------- ç≈ëÂâ◊èd(COP1Z) --------------------------
;	------- ç≈è¨â◊èd(œ≤≈Ωç≈ëÂ?),ïùêMçÜÇÕ∏ÿ±-----------
	MOV.L	#_KJYU_CMP_SEQMINS,R5		;
	MOV.W	@R5,R0				;
	AND	#LOW ~(BIT2|BIT1|BIT0),R0	;
	MOV.W	R0,@R5				;

	MOV.L	#_KJYU_CMP_SEQHABA,R5
	MOV.W	@R5,R0				;
	AND	#LOW ~(BIT2|BIT1|BIT0),R0	;
	MOV.W	R0,@R5				;
	M_BRA	KAJYU_OVERLOADCK_EXT		;


;	------- ç≈è¨â◊èd(œ≤≈Ωç≈ëÂ?)-----
KAJYU_OVERLOADCK_100:


	XOR	R8,R8				;SEQ
	MOV.W	#BIT0,R7			;
	MOV.L	#_BTOA_LFT_MIN,R5		;4BïÑçÜït
	MOV.L	#_SVP_OVERE1_A27,R6		;2BïÑçÜñ≥Çµ  â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇP Å@Åiç≈è¨ílÅj
	FAR_JSR	#_KAJYU_OVER_NEGCMP,R0		;

	MOV.W	#BIT1,R7			;
	MOV.L	#_BTOA_RIH_MIN,R5		;4BïÑçÜït
	MOV.L	#_SVP_OVERE2_A27,R6		;2BïÑçÜñ≥Çµ  â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇQ  Å@Åiç≈è¨ílÅj
	FAR_JSR	#_KAJYU_OVER_NEGCMP,R0		;

	MOV.W	#BIT2,R7			;
	MOV.L	#_BTOA_TTL_MIN,R5		;4BïÑçÜït
	MOV.L	#_SVP_OVERE3_A27,R6		;2BïÑçÜñ≥Çµ  â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇR  Å@Åiç≈è¨ílÅj
	FAR_JSR	#_KAJYU_OVER_NEGCMP,R0		;


	MOV.L	#_KJYU_CMP_SEQMINS,R5		;î‰ärêMçÜæØƒ
	MOV.W	@R5,R0				;
	OR	R8,R0
	MOV.W	R0,@R5				;


	MOV.L	#_KJYU_CMP_SEQHABA,R5		;
	MOV.W	@R5,R0				;
	AND	#LOW ~(BIT2|BIT1|BIT0),R0	;
	MOV.W	R0,@R5				;ïùêMçÜÇÕ∏ÿ±
	M_BRA	KAJYU_OVERLOADCK_EXT		;

;	------- ïùêMçÜ-----------
KAJYU_OVERLOADCK_200:

	XOR	R8,R8				;SEQ
	MOV.W	#BIT0,R7			;
	MOV.L	#_BTOA_LFT_HAB,R5		;4BïÑçÜït
	MOV.L	#_SVP_OVERE1_A28,R6		;2BïÑçÜñ≥Çµ  â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇP Å@ÅiïùÅj
	FAR_JSR	#_KAJYU_OVER_CMP,R0		;

	MOV.W	#BIT1,R7			;
	MOV.L	#_BTOA_RIH_HAB,R5		;4BïÑçÜït
	MOV.L	#_SVP_OVERE2_A28,R6		;2BïÑçÜñ≥Çµ  â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇQ  Å@ÅiïùÅj
	FAR_JSR	#_KAJYU_OVER_CMP,R0		;

	MOV.W	#BIT2,R7			;
	MOV.L	#_BTOA_TTL_HAB,R5		;4BïÑçÜït
	MOV.L	#_SVP_OVERE3_A28,R6		;2BïÑçÜñ≥Çµ  â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇR  Å@ÅiïùÅj
	FAR_JSR	#_KAJYU_OVER_CMP,R0		;


	MOV.L	#_KJYU_CMP_SEQHABA,R5		;î‰ärêMçÜæØƒ
	MOV.W	@R5,R0				;
	OR	R8,R0
	MOV.W	R0,@R5				;


	MOV.L	#_KJYU_CMP_SEQMINS,R5		;œ≤≈ΩêMçÜÇÕ∏ÿ±
	MOV.W	@R5,R0				;
	AND	#LOW ~(BIT2|BIT1|BIT0),R0	;
	MOV.W	R0,@R5				;
KAJYU_OVERLOADCK_EXT:

	SUB_END
	M_RTS



;	*******************************************
;	***					***
;	***	ïÑçÜïtî‰ärÇ≈ëÂÇ´ÇØÇÍÇŒê≥èÌ	***
;	***					***
;	*******************************************
;
;
_KAJYU_OVER_NEGCMP:
	SUB_START
	MOV.L	@R5,R2			;
	MOV.W	@R6,R3			;
	EXTU.W	R3,R3			;ïÑçÜñ≥Çµ
	NEG	R3,R3			;

	CMP/GE	R3,R2			;
	BT KAJYU_OVER_NEGCP_END		;-300 =< -200 THEN JUMP

	OR	R7,R8			;ABNOMAL º∞π›ΩÀﬁØƒON

KAJYU_OVER_NEGCP_END:


	SUB_END
	M_RTS



;	*******************************************
;	***					***
;	***	ïÑçÜïtî‰ärÇ≈ëÂÇ´ÇØÇÍÇŒàŸèÌ	***
;	***					***
;	*******************************************
_KAJYU_OVER_CMP:
	SUB_START
	MOV.L	@R5,R2			;
	MOV.W	@R6,R3			;
	EXTU.W	R3,R3			;ïÑçÜñ≥Çµ

	CMP/GE	R3,R2			;
	BF	KAJYU_OVER_CP_END	;200 < 300? NO! THEN JUMP
	OR	R7,R8			;º∞π›ΩÀﬁØƒON
KAJYU_OVER_CP_END:

	SUB_END
	M_RTS




;	*******************************************
;	***					***
;	***	€±ÿ–Øƒ				***
;	***					***
;	*******************************************
_KAJYU_LOWLIMIT_CHK
	SUB_START


;;;;	MOV.L	#_KJYU_CMP_SELSW2,R1		;
	MOV.L	#_CB_SEQ_SW_SEL058,R1		;00
	MOV.W	@R1,R0				;
	SHLR8	R0				;BIT11,BIT10=00,01,10
	AND	#(BIT3+BIT2),R0			;

	CMP/EQ	#BIT2,R0			;ç≈è¨â◊èd(œ≤≈Ωç≈ëÂ?)
	BT	KAJYU_LOWLIMITCK_100		;
	
	CMP/EQ	#BIT3,R0			;ïù?
	BT	KAJYU_LOWLIMITCK_200		;

;	------- ç≈ëÂâ◊èd(COP1Z) --------------------------
;	------- ç≈è¨â◊èd(œ≤≈Ωç≈ëÂ?),ïùêMçÜÇÕ∏ÿ±-----------
	MOV.L	#_KJYU_CMP_SEQMINS,R5		;
	MOV.W	@R5,R0				;
	AND	#LOW ~(BIT5|BIT4|BIT3),R0	;
	MOV.W	R0,@R5				;
	MOV.L	#_KJYU_CMP_SEQHABA,R5
	MOV.W	@R5,R0				;
	AND	#LOW ~(BIT5|BIT4|BIT3),R0	;
	MOV.W	R0,@R5				;
	M_BRA	KAJYU_LOWLIMITCK_EXT		;


;	------- ç≈è¨â◊èd(œ≤≈Ωç≈ëÂ?)-----
KAJYU_LOWLIMITCK_100:


	XOR	R8,R8				;SEQ
	MOV.W	#BIT3,R7			;
	MOV.L	#_BTOA_LFT_MIN,R5		;4BïÑçÜït
	MOV.L	#_SVP_ROALM1_A27,R6		;2BïÑçÜñ≥Çµ  â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇP Å@Åiç≈è¨ílÅj
	FAR_JSR	#_KAJYU_LOWLMT_NEGCMP,R0		;

	MOV.W	#BIT4,R7			;
	MOV.L	#_BTOA_RIH_MIN,R5		;4BïÑçÜït
	MOV.L	#_SVP_ROALM2_A27,R6		;2BïÑçÜñ≥Çµ  â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇQ  Å@Åiç≈è¨ílÅj
	FAR_JSR	#_KAJYU_LOWLMT_NEGCMP,R0		;

	MOV.W	#BIT5,R7			;
	MOV.L	#_BTOA_TTL_MIN,R5		;4BïÑçÜït
	MOV.L	#_SVP_ROALM3_A27,R6		;2BïÑçÜñ≥Çµ  â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇR  Å@Åiç≈è¨ílÅj
	FAR_JSR	#_KAJYU_LOWLMT_NEGCMP,R0		;


	MOV.L	#_KJYU_CMP_SEQMINS,R5		;î‰ärêMçÜæØƒ
	MOV.W	@R5,R0				;
	OR	R8,R0
	MOV.W	R0,@R5				;


	MOV.L	#_KJYU_CMP_SEQHABA,R5		;
	MOV.W	@R5,R0				;
	AND	#LOW ~(BIT5|BIT4|BIT3),R0	;
	MOV.W	R0,@R5				;ïùêMçÜÇÕ∏ÿ±
	M_BRA	KAJYU_LOWLIMITCK_EXT		;

;	------- ïùêMçÜ-----------
KAJYU_LOWLIMITCK_200:

	XOR	R8,R8				;SEQ
	MOV.W	#BIT3,R7			;
	MOV.L	#_BTOA_LFT_HAB,R5		;4BïÑçÜït
	MOV.L	#_SVP_ROALM1_A28,R6		;2BïÑçÜñ≥Çµ  â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇP Å@ÅiïùÅj
	FAR_JSR	#_KAJYU_LOWLMT_CMP,R0		;

	MOV.W	#BIT4,R7			;
	MOV.L	#_BTOA_RIH_HAB,R5		;4BïÑçÜït
	MOV.L	#_SVP_ROALM2_A28,R6		;2BïÑçÜñ≥Çµ  â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇQ  Å@ÅiïùÅj
	FAR_JSR	#_KAJYU_LOWLMT_CMP,R0		;

	MOV.W	#BIT5,R7			;
	MOV.L	#_BTOA_TTL_HAB,R5		;4BïÑçÜït
	MOV.L	#_SVP_ROALM3_A28,R6		;2BïÑçÜñ≥Çµ  â◊èdåvÅ@ÉIÅ[ÉoÅ[ÉçÅ[ÉhÇR  Å@ÅiïùÅj
	FAR_JSR	#_KAJYU_LOWLMT_CMP,R0		;


	MOV.L	#_KJYU_CMP_SEQHABA,R5		;î‰ärêMçÜæØƒ
	MOV.W	@R5,R0				;
	OR	R8,R0
	MOV.W	R0,@R5				;


	MOV.L	#_KJYU_CMP_SEQMINS,R5		;œ≤≈ΩêMçÜÇÕ∏ÿ±
	MOV.W	@R5,R0				;
	AND	#LOW ~(BIT5|BIT4|BIT3),R0	;
	MOV.W	R0,@R5				;
KAJYU_LOWLIMITCK_EXT:

	SUB_END
	M_RTS


;	*******************************************
;	***					***
;	***	ïÑçÜïtî‰ärÇ≈è¨Ç≥ÇØÇÍÇŒê≥èÌ	***
;	***					***
;	*******************************************
;
;
_KAJYU_LOWLMT_NEGCMP:
	SUB_START
	MOV.L	@R5,R2			;PV
	MOV.W	@R6,R3			;SV
	EXTU.W	R3,R3			;ïÑçÜñ≥Çµ
	NEG	R3,R3			;

	CMP/GT	R3,R2			;
	BF KAJYU_LOWLMT_NEGCP_END	;-300(R3) < -200(R2) NO! R3(-300) >=R2(-400)

	OR	R7,R8			;ABNOMAL º∞π›ΩÀﬁØƒON

KAJYU_LOWLMT_NEGCP_END:


	SUB_END
	M_RTS



;	*******************************************
;	***					***
;	***	ïÑçÜïtî‰ärÇ≈è¨Ç≥ÇØÇÍÇŒàŸèÌ	***
;	***					***
;	*******************************************
_KAJYU_LOWLMT_CMP:
	SUB_START
	MOV.L	@R5,R2			;
	MOV.W	@R6,R3			;
	EXTU.W	R3,R3			;ïÑçÜñ≥Çµ

	CMP/GE	R3,R2			;
	BT	KAJYU_LOWLMT_CP_END	;200(R3) <= 300 (R2)? THEN NOMAL JUMP
	OR	R7,R8			;º∞π›ΩÀﬁØƒON
KAJYU_LOWLMT_CP_END:

	SUB_END
	M_RTS


;	*******************************************
;	****		â◊èd√ﬁ ﬁØ∏óp		***
;	*******************************************
;	CPUBë§Éf10î{ÉVÉeÉCÉã
;	0     ~ 130.0    =0KN
;	130.0 ~ 150.0    = (äpìx-130.0)*10(cpua)*10(cpub)= 0~2000kn
;	150.0 ~          =0kn

	.IMPORT	_PVPAB_DBG_KYUIN1	;()
	.IMPORT	_PVPAB_DBG_KYUIN2	;()
	.IMPORT	_PVPAB_DBG_KYUIN3	;()
	.IMPORT	_TRD_SMP_PV_PGDG	;

_KAJYUU_DEBUG_ANACHG
	SUB_START

	MOV.L	#_TRD_SMP_PV_PGDG,R4		;
	MOV.W	@R4,R2				;0~360.0

;;;;	FAR_JSR	#_KAJYUU_DEBUG_ANACG1,R0
	FAR_JSR	#_KAJYUU_DEBUG_ANACG2,R0


;	R2Ç10î{Ç∑ÇÈ(CPUBÇ™10î{ÇµÇƒÇ¢ÇÈÇÃÇ≈é¿éø100î{)

	MOV.W	#D'10,R3			;180(cpua*10)->1800->(cpub*10)=18000
	DMULS.L	R3,R2				;
	STS	MACL,R2				;

	MOV	R2,R3
	ADD	#D'10,R3			;
	MOV	R2,R4				;
	ADD	#D'20,R4			;

	MOV.L	#_PVPAB_DBG_KYUIN1,R1		;
	SWAP.B	R2,R2				;≤›√Ÿ(ç∂)
	MOV.W	R2,@R1				;

	MOV.L	#_PVPAB_DBG_KYUIN2,R1		;
	SWAP.B	R3,R3				;≤›√Ÿ(çáåv)
	MOV.W	R3,@R1				;

	MOV.L	#_PVPAB_DBG_KYUIN3,R1		;
	SWAP.B	R4,R4				;≤›√Ÿ(âE)
	MOV.W	R4,@R1				;

	SUB_END
	M_RTS


;	***********************************
;	***				***
;	***Å@Ç†ÇÈãÊä‘ÇæÇØâ◊èdëùâ¡	***
;	***Å@Ç†ÇÈãÊä‘à»äOÇÕ0KN		***
;	***				***
;	***********************************
_KAJYUU_DEBUG_ANACG1
	SUB_START

	MOV.W	#D'1300,R4			;130.0ìx
	MOV.W	#D'1500,R1			;150.0ìx

	CMP/HS	R1,R2				;
	BF	KAJYUU_DBG_ANACG1_050		;
	XOR	R2,R2				;150.0~360.0:THEN 0
	M_BRA	KAJYUU_DBG_ANACG1_100		;


KAJYUU_DBG_ANACG1_050				;
	SUB	R4,R2				;
	CMP/PZ	R2				;
	BT	KAJYUU_DBG_ANACG1_100		;JUMP(130.0~150.0)
	XOR	R2,R2				;0~130.0ìx
KAJYUU_DBG_ANACG1_100				;

	SUB_END
	M_RTS


;	***********************************
;	***				***
;	***	Ç”ÇËÇ±óp2ãÊä‘		***
;	***				***
;	***********************************
_KAJYUU_DEBUG_ANACG2
	SUB_START

	MOV.W	#D'1300,R4			;130.0ìx
	MOV.W	#D'1500,R1			;150.0ìx

	CMP/HS	R1,R2				;
	BF	KAJYUU_DBG_ANACG2_050		;
	M_BRA	KAJYUU_DBG_ANACG2_100		;150.0~360.0:THEN 0

;	0~150.0
KAJYUU_DBG_ANACG2_050				;
	SUB	R4,R2				;
	CMP/PZ	R2				;
	BT	KAJYUU_DBG_ANACG2_090		;JUMP(130.0~150.0)
	XOR	R2,R2				;0~130.0ìx
KAJYUU_DBG_ANACG2_090				;
	M_BRA	KAJYUU_DBG_ANACG2_END		;

;	----------- ïúòHóp-------------
KAJYUU_DBG_ANACG2_100				;
	MOV.W	#D'2300,R1			;3600-130.0ìx
	MOV.W	#D'2100,R4			;3600-150.0ìx

	CMP/HS	R1,R2				;
	BF	KAJYUU_DBG_ANACG2_150		;
	XOR	R2,R2				;2300~3600
	M_BRA	KAJYUU_DBG_ANACG2_END		;

;	0~150.0
KAJYUU_DBG_ANACG2_150				;
	SUB	R4,R2				;
	CMP/PZ	R2				;
	BT	KAJYUU_DBG_ANACG2_190		;JUMP(130.0~150.0)
	XOR	R2,R2				;180~210.0ìx
	M_BRA	KAJYUU_DBG_ANACG2_END		;
KAJYUU_DBG_ANACG2_190				;
	MOV	R2,R4				;
	MOV.W	#(D'2300-D'2100)+1,R2		;201-**
	SUB	R4,R2				;
KAJYUU_DBG_ANACG2_END				;


	SUB_END
	M_RTS


;;;_KAJYUU_SHOT_ADR_SET:
;;;	SUB_START
;;;	MOV.L	#_SET1_KAJAREA_SEL,R1	;//ƒ⁄›ƒﬁâ◊èdï\é¶ëIë0:(ç≈ëÂ),1:(ç≈è¨),2(ïù)
;;;	MOV.W	@R1,R0			;
;;;
;;;	MOV.L	#_BTOA_LFT_TRDHAB,R1
;;;	MOV.L	#_BTOA_RIH_TRDHAB,R2
;;;	MOV.L	#_BTOA_TTL_TRDHAB,R4
;;;	CMP/EQ	#2,R0			;
;;;	BT KAJYUU_SHOTADRSET_100
;;;
;;;
;;;	MOV.L	#_BTOA_LFT_TRDMIN,R1
;;;	MOV.L	#_BTOA_RIH_TRDMIN,R2
;;;	MOV.L	#_BTOA_TTL_TRDMIN,R4
;;;
;;;	CMP/EQ	#1,R0			;
;;;	BT KAJYUU_SHOTADRSET_100
;;;
;;;	MOV.L	#_BTOA_LFT_TRDMAX,R1
;;;	MOV.L	#_BTOA_RIH_TRDMAX,R2
;;;	MOV.L	#_BTOA_TTL_TRDMAX,R4
;;;
;;;KAJYUU_SHOTADRSET_100:
;;;
;;;	MOV.L	#_SHOT_ADR_LFT,R0		;ADR
;;;	MOV.L	R1,@R0
;;;	MOV.L	#_SHOT_ADR_RIH,R0		;ADR
;;;	MOV.L	R2,@R0
;;;	MOV.L	#_SHOT_ADR_TTL,R0		;ADR
;;;	MOV.L	R4,@R0
;;;
;;;	SUB_END
;;;	M_RTS
